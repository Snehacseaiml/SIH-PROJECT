<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title || 'Dashboard - RockGuard AI' %></title>
    <link rel="stylesheet" href="/styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="brand">
                    <i class="fas fa-mountain"></i>
                    <span>RockGuard AI</span>
                </div>
            </div>
            
            <nav class="sidebar-nav">
                <ul>
                    <li class="active">
                        <a href="/dashboard">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li>
                        <a href="#monitoring">
                            <i class="fas fa-eye"></i>
                            <span>Monitoring</span>
                        </a>
                    </li>
                    <li>
                        <a href="#alerts">
                            <i class="fas fa-bell"></i>
                            <span>Alerts</span>
                        </a>
                    </li>
                    <li>
                        <a href="#reports">
                            <i class="fas fa-chart-bar"></i>
                            <span>Reports</span>
                        </a>
                    </li>
                    <li>
                        <a href="#settings">
                            <i class="fas fa-cog"></i>
                            <span>Settings</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="dashboard-header">
                <div class="header-left">
                    <h1>Dashboard</h1>
                    <p>Welcome back, <%= user.firstName %>!</p>
                </div>
                <div class="header-right">
                    <div class="user-menu">
                        <span><%= user.firstName %> <%= user.lastName %></span>
                        <a href="/logout" class="btn-logout">
                            <i class="fas fa-sign-out-alt"></i>
                            Logout
                        </a>
                    </div>
                </div>
            </header>

            <!-- Dashboard Content -->
            <div class="dashboard-content">
                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="stat-content">
                            <h3>99.8%</h3>
                            <p>System Uptime</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="stat-content">
                            <h3>2</h3>
                            <p>Active Alerts</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-map-marked-alt"></i>
                        </div>
                        <div class="stat-content">
                            <h3>15</h3>
                            <p>Monitored Zones</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-content">
                            <h3>24/7</h3>
                            <p>Monitoring</p>
                        </div>
                    </div>
                </div>

                <!-- Main Dashboard Grid -->
                <div class="dashboard-grid">
                    <!-- Risk Map -->
                    <div class="dashboard-card risk-map-card">
                        <div class="card-header">
                            <h3>Live Risk Map</h3>
                            <div class="status-indicator active"></div>
                        </div>
                        <div class="risk-map-container">
                            <div class="risk-map">
                                <div class="risk-zone high" data-zone="A">
                                    <span>Zone A</span>
                                    <div class="risk-level">High Risk</div>
                                </div>
                                <div class="risk-zone medium" data-zone="B">
                                    <span>Zone B</span>
                                    <div class="risk-level">Medium Risk</div>
                                </div>
                                <div class="risk-zone low" data-zone="C">
                                    <span>Zone C</span>
                                    <div class="risk-level">Low Risk</div>
                                </div>
                                <div class="risk-zone safe" data-zone="D">
                                    <span>Zone D</span>
                                    <div class="risk-level">Safe</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Alerts -->
                    <div class="dashboard-card alerts-card">
                        <div class="card-header">
                            <h3>Recent Alerts</h3>
                            <a href="#alerts" class="view-all">View All</a>
                        </div>
                        <div class="alerts-list">
                            <div class="alert-item high">
                                <div class="alert-icon">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                                <div class="alert-content">
                                    <h4>Zone A - High Risk Detected</h4>
                                    <p>Unusual movement detected in Zone A. Immediate attention required.</p>
                                    <span class="alert-time">2 minutes ago</span>
                                </div>
                            </div>
                            <div class="alert-item medium">
                                <div class="alert-icon">
                                    <i class="fas fa-exclamation-circle"></i>
                                </div>
                                <div class="alert-content">
                                    <h4>Zone B - Medium Risk Warning</h4>
                                    <p>Minor displacement detected. Monitor closely.</p>
                                    <span class="alert-time">15 minutes ago</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- System Status -->
                    <div class="dashboard-card status-card">
                        <div class="card-header">
                            <h3>System Status</h3>
                        </div>
                        <div class="status-list">
                            <div class="status-item">
                                <span class="status-label">AI Model</span>
                                <span class="status-value online">Online</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">Sensors</span>
                                <span class="status-value online">15/15 Active</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">Database</span>
                                <span class="status-value online">Connected</span>
                            </div>
                            <div class="status-item">
                                <span class="status-label">Notifications</span>
                                <span class="status-value online">Enabled</span>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="dashboard-card actions-card">
                        <div class="card-header">
                            <h3>Quick Actions</h3>
                        </div>
                        <div class="actions-grid">
                            <button class="action-btn">
                                <i class="fas fa-download"></i>
                                <span>Export Report</span>
                            </button>
                            <button class="action-btn">
                                <i class="fas fa-cog"></i>
                                <span>Settings</span>
                            </button>
                            <button class="action-btn">
                                <i class="fas fa-bell"></i>
                                <span>Test Alert</span>
                            </button>
                            <button class="action-btn">
                                <i class="fas fa-question-circle"></i>
                                <span>Help</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Dashboard functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Update risk zones with real-time data simulation
            function updateRiskZones() {
                const zones = document.querySelectorAll('.risk-zone');
                zones.forEach(zone => {
                    const randomRisk = Math.random();
                    if (randomRisk > 0.8) {
                        zone.className = 'risk-zone high';
                        zone.querySelector('.risk-level').textContent = 'High Risk';
                    } else if (randomRisk > 0.6) {
                        zone.className = 'risk-zone medium';
                        zone.querySelector('.risk-level').textContent = 'Medium Risk';
                    } else if (randomRisk > 0.3) {
                        zone.className = 'risk-zone low';
                        zone.querySelector('.risk-level').textContent = 'Low Risk';
                    } else {
                        zone.className = 'risk-zone safe';
                        zone.querySelector('.risk-level').textContent = 'Safe';
                    }
                });
            }

            // Update every 30 seconds
            setInterval(updateRiskZones, 30000);

            // Quick action buttons
            document.querySelectorAll('.action-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const action = this.querySelector('span').textContent;
                    showNotification(`${action} action triggered`, 'info');
                });
            });

            // Risk zone click handlers
            document.querySelectorAll('.risk-zone').forEach(zone => {
                zone.addEventListener('click', function() {
                    const zoneName = this.querySelector('span').textContent;
                    const riskLevel = this.querySelector('.risk-level').textContent;
                    showNotification(`Selected ${zoneName}: ${riskLevel}`, 'info');
                });
            });

            function showNotification(message, type) {
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.innerHTML = `
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                    <span>${message}</span>
                `;
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.remove();
                }, 4000);
            }

            // Display flash messages
            <% if (typeof messages !== 'undefined' && Object.keys(messages).length > 0) { %>
                <% Object.keys(messages).forEach(function(key) { %>
                    <% if (messages[key].length > 0) { %>
                        showNotification('<%= messages[key][0] %>', '<%= key %>');
                    <% } %>
                <% }); %>
            <% } %>
        });
    </script>
</body>
</html>

